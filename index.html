<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Momentylyze - Hebelwerk Momentumtabelle</title>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

</head>

<body>

    <div id="sp500"></div>
    <script type="text/javascript">
        var tabledata = [{"rank":1,"ticker":"CAH","momentum":121.7195291646,"atr":1.689,"price":66.68,"sector":"Health Care","shares":148,"position":9868.64},{"rank":2,"ticker":"MOH","momentum":72.8792844886,"atr":8.320875,"price":329.84,"sector":"Health Care","shares":30,"position":9895.2},{"rank":3,"ticker":"NDAQ","momentum":64.4145153292,"atr":1.375495,"price":56.68,"sector":"Financials","shares":181,"position":10259.08},{"rank":4,"ticker":"KEYS","momentum":57.5804529637,"atr":3.9648,"price":157.36,"sector":"Information Technology","shares":63,"position":9913.68},{"rank":5,"ticker":"GPC","momentum":57.5071416171,"atr":3.51196,"price":149.32,"sector":"Consumer Discretionary","shares":71,"position":10601.72},{"rank":6,"ticker":"LW","momentum":54.7048333026,"atr":1.98825,"price":77.38,"sector":"Consumer Staples","shares":125,"position":9672.5},{"rank":7,"ticker":"TT","momentum":53.5708205394,"atr":4.30225,"price":144.81,"sector":"Industrials","shares":58,"position":8398.98},{"rank":8,"ticker":"SBUX","momentum":52.2668590609,"atr":2.63498,"price":84.26,"sector":"Consumer Discretionary","shares":94,"position":7920.44},{"rank":9,"ticker":"IT","momentum":50.3754284399,"atr":8.14134,"price":276.69,"sector":"Information Technology","shares":30,"position":8300.7},{"rank":10,"ticker":"ON","momentum":43.9784820796,"atr":3.05528,"price":62.33,"sector":"Information Technology","shares":81,"position":5048.73},{"rank":11,"ticker":"ORLY","momentum":41.8055187417,"atr":15.38332,"price":703.35,"sector":"Consumer Discretionary","shares":16,"position":11253.6},{"rank":12,"ticker":"XYL","momentum":39.8369885982,"atr":2.68125,"price":87.36,"sector":"Industrials","shares":93,"position":8124.48},{"rank":13,"ticker":"SJM","momentum":39.7350728787,"atr":2.91082,"price":137.41,"sector":"Consumer Staples","shares":85,"position":11679.85},{"rank":14,"ticker":"RJF","momentum":37.1230923511,"atr":2.89129,"price":98.82,"sector":"Financials","shares":86,"position":8498.52},{"rank":15,"ticker":"AJG","momentum":36.8188596204,"atr":3.78716,"price":171.22,"sector":"Financials","shares":66,"position":11300.52},{"rank":16,"ticker":"GIS","momentum":33.1788611641,"atr":1.74901,"price":76.61,"sector":"Consumer Staples","shares":142,"position":10878.62},{"rank":17,"ticker":"HII","momentum":28.8414354808,"atr":5.597125,"price":221.5,"sector":"Industrials","shares":44,"position":9746.0},{"rank":18,"ticker":"MCK","momentum":28.2433830758,"atr":8.446745,"price":339.87,"sector":"Health Care","shares":29,"position":9856.23},{"rank":19,"ticker":"CI","momentum":27.6821772451,"atr":6.12275,"price":277.47,"sector":"Health Care","shares":40,"position":11098.8},{"rank":20,"ticker":"SCHW","momentum":27.1755717093,"atr":2.03593,"price":71.87,"sector":"Financials","shares":122,"position":8768.14},{"rank":21,"ticker":"PCG","momentum":26.0801609079,"atr":0.451205,"price":12.5,"sector":"Utilities","shares":554,"position":6925.0},{"rank":22,"ticker":"IEX","momentum":24.6342748158,"atr":4.403165,"price":199.85,"sector":"Industrials","shares":56,"position":11191.6},{"rank":23,"ticker":"WMT","momentum":22.3769771062,"atr":2.814275,"price":129.7,"sector":"Consumer Staples","shares":88,"position":11413.6},{"rank":24,"ticker":"CF","momentum":19.085134964,"atr":4.941875,"price":96.25,"sector":"Materials","shares":50,"position":4812.5},{"rank":25,"ticker":"PFG","momentum":16.9067217883,"atr":1.99794,"price":72.15,"sector":"Financials","shares":125,"position":9018.75},{"rank":26,"ticker":"HSY","momentum":14.4409414434,"atr":4.378145,"price":220.47,"sector":"Consumer Staples","shares":57,"position":12566.79},{"rank":27,"ticker":"MTB","momentum":13.2591630854,"atr":5.40754,"price":176.32,"sector":"Financials","shares":46,"position":8110.72},{"rank":28,"ticker":"CBOE","momentum":12.4903633812,"atr":2.755465,"price":117.37,"sector":"Financials","shares":90,"position":10563.3},{"rank":29,"ticker":"DRI","momentum":11.9320906821,"atr":4.032895,"price":126.32,"sector":"Consumer Discretionary","shares":61,"position":7705.52},{"rank":30,"ticker":"GL","momentum":8.2930375648,"atr":2.22325,"price":99.7,"sector":"Financials","shares":112,"position":11166.4},{"rank":31,"ticker":"TJX","momentum":8.1516591506,"atr":1.84178,"price":62.12,"sector":"Consumer Discretionary","shares":135,"position":8386.2},{"rank":32,"ticker":"VRTX","momentum":8.1423573375,"atr":8.259475,"price":289.54,"sector":"Health Care","shares":30,"position":8686.2},{"rank":33,"ticker":"AZO","momentum":4.5780492274,"atr":55.046605,"price":2141.93,"sector":"Consumer Discretionary","shares":4,"position":8567.72},{"rank":34,"ticker":"DG","momentum":4.5574431709,"atr":4.9535,"price":239.86,"sector":"Consumer Discretionary","shares":50,"position":11993.0},{"rank":35,"ticker":"ULTA","momentum":2.4812817045,"atr":11.677725,"price":401.19,"sector":"Consumer Discretionary","shares":21,"position":8424.99},{"rank":36,"ticker":"COP","momentum":0.3901258434,"atr":4.18341,"price":102.34,"sector":"Energy","shares":59,"position":6038.06},{"rank":37,"ticker":"MPC","momentum":0.0464045847,"atr":3.41121,"price":99.33,"sector":"Energy","shares":73,"position":7251.09},{"rank":38,"ticker":"LLY","momentum":0.0123054001,"atr":9.336425,"price":323.35,"sector":"Health Care","shares":26,"position":8407.1}];

        const sectorTypes = ["Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Health Care", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities"];
        function multiSelectHeaderFilter(cell) {
            var values = sectorTypes;

            const filterFunc = (rowData) => {
                return values.includes(rowData['sector']);
            }

            const getSelectedValues = (multiSelect) => {
                var result = [];
                var options = multiSelect && multiSelect.options;
                var opt;

                for (var i = 0, iLen = options.length; i < iLen; i++) {
                opt = options[i];

                if (opt.selected) {
                    result.push(opt.value || opt.text);
                }
                }
                return result;
            }

            const onChange = () => {
                var editor = document.getElementById('sectorSelector');
                values = getSelectedValues(editor);
                console.log("values: " + values);
                cell.getColumn().getTable().removeFilter(filterFunc);
                cell.getColumn().getTable().addFilter(filterFunc);
            }

            var select = document.createElement("select");
            select.multiple = "multiple";
            select.id = 'sectorSelector';
            select.class = "chosen-select";
            select.style = 'width: 100%';
            sectorTypes.forEach(sector => {
                select.innerHTML += "<option id='" + sector + "' value='" + sector + "' selected='selected'>" + sector + "</option>";
            });
            cell.getColumn().getTable().addFilter(filterFunc);
            select.addEventListener('change', onChange);

            return select;
        }

        var table = new Tabulator("#sp500", {
            data: tabledata,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 500,
            tooltips: true,
            columns: [{
                    title: "Rank",
                    field: "rank",
                    sorter: "number",
                }, 
                {
                    title: "Ticker",
                    field: "ticker",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: "input"
                },
                {
                    title: "Sector",
                    field: "sector",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: multiSelectHeaderFilter, 
                    headerFilterLiveFilter: false
                },
                {
                    title: "Momentum",
                    field: "momentum",
                    sorter: "number",
                    hozAlign: "left",
                }, 
                {
                    title: "ATR20d",
                    field: "atr",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Price ($)",
                    field: "price",
                    sorter: "money",
                    hozAlign: "left",
                },
                {
                    title: "Shares",
                    field: "shares",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Position ($)",
                    field: "position",
                    sorter: "money",
                    hozAlign: "left",
                },
            ],
        });
    </script>
</body>

</html>

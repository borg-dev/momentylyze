<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Momentylyze - Hebelwerk Momentumtabelle</title>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

</head>

<body>

    <div id="sp500"></div>
    <script type="text/javascript">
        var tabledata = [{"rank":1,"ticker":"CTRA","momentum":239.227888286,"atr":1.3485,"price":32.56,"sector":"Energy","shares":185,"position":6023.6},{"rank":2,"ticker":"MPC","momentum":153.9012560213,"atr":3.19596,"price":102.17,"sector":"Energy","shares":78,"position":7969.26},{"rank":3,"ticker":"DVN","momentum":142.0391828947,"atr":3.02857,"price":69.24,"sector":"Energy","shares":82,"position":5677.68},{"rank":4,"ticker":"CEG","momentum":100.7860781244,"atr":2.979325,"price":55.48,"sector":"Utilities","shares":83,"position":4604.84},{"rank":5,"ticker":"LLY","momentum":78.724759801,"atr":9.81975,"price":291.28,"sector":"Health Care","shares":25,"position":7282.0},{"rank":6,"ticker":"MRK","momentum":75.1288318772,"atr":1.8265,"price":85.0,"sector":"Health Care","shares":136,"position":11560.0},{"rank":7,"ticker":"MCK","momentum":66.1477559999,"atr":8.69945,"price":306.99,"sector":"Health Care","shares":28,"position":8595.72},{"rank":8,"ticker":"CVX","momentum":61.4267895114,"atr":4.710735,"price":167.33,"sector":"Energy","shares":53,"position":8868.49},{"rank":9,"ticker":"COP","momentum":56.4095315531,"atr":4.1795,"price":111.76,"sector":"Energy","shares":59,"position":6593.84},{"rank":10,"ticker":"T","momentum":53.7141723231,"atr":0.414055,"price":19.76,"sector":"Communication Services","shares":603,"position":11915.28},{"rank":11,"ticker":"WRB","momentum":51.7966770744,"atr":1.530195,"price":66.3,"sector":"Financials","shares":163,"position":10806.9},{"rank":12,"ticker":"CTVA","momentum":48.364008407,"atr":1.64265,"price":56.24,"sector":"Materials","shares":152,"position":8548.48},{"rank":13,"ticker":"HAL","momentum":43.9854550081,"atr":1.7563,"price":37.53,"sector":"Energy","shares":142,"position":5329.26},{"rank":14,"ticker":"AMCR","momentum":37.2399484853,"atr":0.334635,"price":12.29,"sector":"Materials","shares":747,"position":9180.63},{"rank":15,"ticker":"PSX","momentum":36.9996980906,"atr":3.219765,"price":101.44,"sector":"Energy","shares":77,"position":7810.88},{"rank":16,"ticker":"NOC","momentum":34.9051721902,"atr":12.431785,"price":460.68,"sector":"Industrials","shares":20,"position":9213.6},{"rank":17,"ticker":"NRG","momentum":30.4854840882,"atr":1.33474,"price":40.55,"sector":"Utilities","shares":187,"position":7582.85},{"rank":18,"ticker":"K","momentum":28.3176442413,"atr":1.753455,"price":68.86,"sector":"Consumer Staples","shares":142,"position":9778.12},{"rank":19,"ticker":"CPB","momentum":20.0186118685,"atr":1.46519,"price":45.86,"sector":"Consumer Staples","shares":170,"position":7796.2},{"rank":20,"ticker":"HII","momentum":18.1774320436,"atr":4.978005,"price":207.33,"sector":"Industrials","shares":50,"position":10366.5},{"rank":21,"ticker":"SLB","momentum":17.1415546195,"atr":1.933645,"price":44.32,"sector":"Energy","shares":129,"position":5717.28},{"rank":22,"ticker":"GPC","momentum":16.517104895,"atr":3.62584,"price":131.61,"sector":"Consumer Discretionary","shares":68,"position":8949.48},{"rank":23,"ticker":"MNST","momentum":13.5850626407,"atr":2.13255,"price":84.49,"sector":"Consumer Staples","shares":117,"position":9885.33},{"rank":24,"ticker":"DG","momentum":13.5432171041,"atr":10.01497,"price":230.93,"sector":"Consumer Discretionary","shares":24,"position":5542.32},{"rank":25,"ticker":"PGR","momentum":11.5476878106,"atr":2.83675,"price":113.54,"sector":"Financials","shares":88,"position":9991.52},{"rank":26,"ticker":"PWR","momentum":11.4831394006,"atr":4.9545,"price":125.81,"sector":"Industrials","shares":50,"position":6290.5},{"rank":27,"ticker":"FANG","momentum":10.5170751122,"atr":5.98538,"price":147.8,"sector":"Energy","shares":41,"position":6059.8},{"rank":28,"ticker":"IBM","momentum":8.3622884668,"atr":3.346435,"price":135.11,"sector":"Information Technology","shares":74,"position":9998.14},{"rank":29,"ticker":"ULTA","momentum":5.084569085,"atr":19.412895,"price":391.77,"sector":"Consumer Discretionary","shares":12,"position":4701.24},{"rank":30,"ticker":"AZO","momentum":2.9605341027,"atr":75.778865,"price":2026.66,"sector":"Consumer Discretionary","shares":3,"position":6079.98},{"rank":31,"ticker":"EA","momentum":0.0127117053,"atr":3.835745,"price":128.76,"sector":"Communication Services","shares":65,"position":8369.4},{"rank":32,"ticker":"CTLT","momentum":0.0007291171,"atr":3.699775,"price":103.35,"sector":"Health Care","shares":67,"position":6924.45}];

        const sectorTypes = ["Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Health Care", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities"];
        function multiSelectHeaderFilter(cell) {
            var values = sectorTypes;

            const filterFunc = (rowData) => {
                return values.includes(rowData['sector']);
            }

            const getSelectedValues = (multiSelect) => {
                var result = [];
                var options = multiSelect && multiSelect.options;
                var opt;

                for (var i = 0, iLen = options.length; i < iLen; i++) {
                opt = options[i];

                if (opt.selected) {
                    result.push(opt.value || opt.text);
                }
                }
                return result;
            }

            const onChange = () => {
                var editor = document.getElementById('sectorSelector');
                values = getSelectedValues(editor);
                console.log("values: " + values);
                cell.getColumn().getTable().removeFilter(filterFunc);
                cell.getColumn().getTable().addFilter(filterFunc);
            }

            var select = document.createElement("select");
            select.multiple = "multiple";
            select.id = 'sectorSelector';
            select.class = "chosen-select";
            select.style = 'width: 100%';
            sectorTypes.forEach(sector => {
                select.innerHTML += "<option id='" + sector + "' value='" + sector + "' selected='selected'>" + sector + "</option>";
            });
            cell.getColumn().getTable().addFilter(filterFunc);
            select.addEventListener('change', onChange);

            return select;
        }

        var table = new Tabulator("#sp500", {
            data: tabledata,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 500,
            tooltips: true,
            columns: [{
                    title: "Rank",
                    field: "rank",
                    sorter: "number",
                }, 
                {
                    title: "Ticker",
                    field: "ticker",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: "input"
                },
                {
                    title: "Sector",
                    field: "sector",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: multiSelectHeaderFilter, 
                    headerFilterLiveFilter: false
                },
                {
                    title: "Momentum",
                    field: "momentum",
                    sorter: "number",
                    hozAlign: "left",
                }, 
                {
                    title: "ATR20d",
                    field: "atr",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Price ($)",
                    field: "price",
                    sorter: "money",
                    hozAlign: "left",
                },
                {
                    title: "Shares",
                    field: "shares",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Position ($)",
                    field: "position",
                    sorter: "money",
                    hozAlign: "left",
                },
            ],
        });
    </script>
</body>

</html>

<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Momentylyze - Hebelwerk Momentumtabelle</title>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

</head>

<body>

    <div id="sp500"></div>
    <script type="text/javascript">
        var tabledata = [{"rank":1,"ticker":"CAH","momentum":109.1708329291,"atr":1.60375,"price":65.77,"sector":"Health Care","shares":155,"position":10194.35},{"rank":2,"ticker":"NDAQ","momentum":89.6830173286,"atr":1.313665,"price":56.57,"sector":"Financials","shares":190,"position":10748.3},{"rank":3,"ticker":"AES","momentum":77.9825036856,"atr":0.75063,"price":22.96,"sector":"Utilities","shares":333,"position":7645.68},{"rank":4,"ticker":"LW","momentum":74.0412185784,"atr":1.866,"price":77.67,"sector":"Consumer Staples","shares":133,"position":10330.11},{"rank":5,"ticker":"GPC","momentum":72.1282348422,"atr":3.24116,"price":149.13,"sector":"Consumer Discretionary","shares":77,"position":11483.01},{"rank":6,"ticker":"KEYS","momentum":71.8484723191,"atr":3.87284,"price":155.56,"sector":"Information Technology","shares":64,"position":9955.84},{"rank":7,"ticker":"TT","momentum":66.9397177127,"atr":4.12125,"price":146.08,"sector":"Industrials","shares":60,"position":8764.8},{"rank":8,"ticker":"SBUX","momentum":64.5774674024,"atr":2.48473,"price":84.81,"sector":"Consumer Discretionary","shares":100,"position":8481.0},{"rank":9,"ticker":"IT","momentum":59.4897351866,"atr":8.121,"price":274.75,"sector":"Information Technology","shares":30,"position":8242.5},{"rank":10,"ticker":"MOH","momentum":57.1409494261,"atr":8.703545,"price":326.82,"sector":"Health Care","shares":28,"position":9150.96},{"rank":11,"ticker":"NEE","momentum":56.6421263818,"atr":2.05652,"price":81.15,"sector":"Utilities","shares":121,"position":9819.15},{"rank":12,"ticker":"ON","momentum":53.2708446698,"atr":3.05052,"price":62.7,"sector":"Information Technology","shares":81,"position":5078.7},{"rank":13,"ticker":"ORLY","momentum":52.7525907763,"atr":14.12882,"price":693.72,"sector":"Consumer Discretionary","shares":17,"position":11793.24},{"rank":14,"ticker":"XYL","momentum":48.0216098075,"atr":2.532,"price":88.89,"sector":"Industrials","shares":98,"position":8711.22},{"rank":15,"ticker":"RJF","momentum":45.1591476814,"atr":2.66904,"price":100.74,"sector":"Financials","shares":93,"position":9368.82},{"rank":16,"ticker":"SJM","momentum":42.3726752411,"atr":2.73657,"price":139.52,"sector":"Consumer Staples","shares":91,"position":12696.32},{"rank":17,"ticker":"HII","momentum":38.7221037311,"atr":5.46281,"price":226.86,"sector":"Industrials","shares":45,"position":10208.7},{"rank":18,"ticker":"GIS","momentum":38.5252246249,"atr":1.68401,"price":78.66,"sector":"Consumer Staples","shares":148,"position":11641.68},{"rank":19,"ticker":"ADP","momentum":35.5499836877,"atr":5.05198,"price":228.64,"sector":"Information Technology","shares":49,"position":11203.36},{"rank":20,"ticker":"RSG","momentum":35.1823490126,"atr":2.500135,"price":140.07,"sector":"Industrials","shares":99,"position":13866.93},{"rank":21,"ticker":"CI","momentum":33.1411871525,"atr":5.909065,"price":276.8,"sector":"Health Care","shares":42,"position":11625.6},{"rank":22,"ticker":"MCK","momentum":32.9688048647,"atr":8.545245,"price":342.88,"sector":"Health Care","shares":29,"position":9943.52},{"rank":23,"ticker":"WM","momentum":32.776007474,"atr":2.6794,"price":165.22,"sector":"Industrials","shares":93,"position":15365.46},{"rank":24,"ticker":"IEX","momentum":30.6676342569,"atr":4.136915,"price":199.62,"sector":"Industrials","shares":60,"position":11977.2},{"rank":25,"ticker":"WMT","momentum":27.5626332363,"atr":2.6932,"price":131.31,"sector":"Consumer Staples","shares":92,"position":12080.52},{"rank":26,"ticker":"SCHW","momentum":26.9447480161,"atr":2.03043,"price":70.89,"sector":"Financials","shares":123,"position":8719.47},{"rank":27,"ticker":"KDP","momentum":24.7319873366,"atr":0.6992,"price":37.28,"sector":"Consumer Staples","shares":357,"position":13308.96},{"rank":28,"ticker":"HSY","momentum":19.738722389,"atr":4.044645,"price":223.78,"sector":"Consumer Staples","shares":61,"position":13650.58},{"rank":29,"ticker":"MTB","momentum":16.819288904,"atr":4.98829,"price":177.12,"sector":"Financials","shares":50,"position":8856.0},{"rank":30,"ticker":"PGR","momentum":16.7576909274,"atr":2.762805,"price":118.88,"sector":"Financials","shares":90,"position":10699.2},{"rank":31,"ticker":"CVS","momentum":16.0941902793,"atr":2.064815,"price":97.74,"sector":"Health Care","shares":121,"position":11826.54},{"rank":32,"ticker":"PFG","momentum":15.62091272,"atr":1.79094,"price":71.34,"sector":"Financials","shares":139,"position":9916.26},{"rank":33,"ticker":"K","momentum":11.082336796,"atr":1.42788,"price":72.93,"sector":"Consumer Staples","shares":175,"position":12762.75},{"rank":34,"ticker":"GL","momentum":10.9811214945,"atr":2.03425,"price":99.04,"sector":"Financials","shares":122,"position":12082.88},{"rank":35,"ticker":"CTXS","momentum":10.2437222316,"atr":0.38365,"price":103.8,"sector":"Information Technology","shares":651,"position":67573.8},{"rank":36,"ticker":"NOC","momentum":7.282708925,"atr":12.26082,"price":474.37,"sector":"Industrials","shares":20,"position":9487.4}];

        const sectorTypes = ["Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Health Care", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities"];
        function multiSelectHeaderFilter(cell) {
            var values = sectorTypes;

            const filterFunc = (rowData) => {
                return values.includes(rowData['sector']);
            }

            const getSelectedValues = (multiSelect) => {
                var result = [];
                var options = multiSelect && multiSelect.options;
                var opt;

                for (var i = 0, iLen = options.length; i < iLen; i++) {
                opt = options[i];

                if (opt.selected) {
                    result.push(opt.value || opt.text);
                }
                }
                return result;
            }

            const onChange = () => {
                var editor = document.getElementById('sectorSelector');
                values = getSelectedValues(editor);
                console.log("values: " + values);
                cell.getColumn().getTable().removeFilter(filterFunc);
                cell.getColumn().getTable().addFilter(filterFunc);
            }

            var select = document.createElement("select");
            select.multiple = "multiple";
            select.id = 'sectorSelector';
            select.class = "chosen-select";
            select.style = 'width: 100%';
            sectorTypes.forEach(sector => {
                select.innerHTML += "<option id='" + sector + "' value='" + sector + "' selected='selected'>" + sector + "</option>";
            });
            cell.getColumn().getTable().addFilter(filterFunc);
            select.addEventListener('change', onChange);

            return select;
        }

        var table = new Tabulator("#sp500", {
            data: tabledata,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 500,
            tooltips: true,
            columns: [{
                    title: "Rank",
                    field: "rank",
                    sorter: "number",
                }, 
                {
                    title: "Ticker",
                    field: "ticker",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: "input"
                },
                {
                    title: "Sector",
                    field: "sector",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: multiSelectHeaderFilter, 
                    headerFilterLiveFilter: false
                },
                {
                    title: "Momentum",
                    field: "momentum",
                    sorter: "number",
                    hozAlign: "left",
                }, 
                {
                    title: "ATR20d",
                    field: "atr",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Price ($)",
                    field: "price",
                    sorter: "money",
                    hozAlign: "left",
                },
                {
                    title: "Shares",
                    field: "shares",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Position ($)",
                    field: "position",
                    sorter: "money",
                    hozAlign: "left",
                },
            ],
        });
    </script>
</body>

</html>

<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Momentylyze - Hebelwerk Momentumtabelle</title>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

</head>

<body>

    <div id="sp500"></div>
    <script type="text/javascript">
        var tabledata = [{"rank":1,"ticker":"VLO","momentum":231.5149612976,"atr":5.85984,"price":123.96,"sector":"Energy","shares":42,"position":5206.32},{"rank":2,"ticker":"CTRA","momentum":221.9730370024,"atr":1.54306,"price":32.37,"sector":"Energy","shares":162,"position":5243.94},{"rank":3,"ticker":"CF","momentum":220.9135392043,"atr":6.28695,"price":101.09,"sector":"Materials","shares":39,"position":3942.51},{"rank":4,"ticker":"MCK","momentum":123.4002911362,"atr":10.0939,"price":327.63,"sector":"Health Care","shares":24,"position":7863.12},{"rank":5,"ticker":"DVN","momentum":113.6690451581,"atr":3.759285,"price":71.06,"sector":"Energy","shares":66,"position":4689.96},{"rank":6,"ticker":"MPC","momentum":109.8411719662,"atr":3.697415,"price":96.91,"sector":"Energy","shares":67,"position":6492.97},{"rank":7,"ticker":"CEG","momentum":102.5821708099,"atr":2.829275,"price":56.6,"sector":"Utilities","shares":88,"position":4980.8},{"rank":8,"ticker":"SRE","momentum":82.1663172784,"atr":3.947155,"price":163.79,"sector":"Utilities","shares":63,"position":10318.77},{"rank":9,"ticker":"WMB","momentum":80.969889515,"atr":1.151,"price":36.02,"sector":"Energy","shares":217,"position":7816.34},{"rank":10,"ticker":"BMY","momentum":80.919186327,"atr":1.646,"price":76.7,"sector":"Health Care","shares":151,"position":11581.7},{"rank":11,"ticker":"AIZ","momentum":77.0551552923,"atr":5.02075,"price":178.49,"sector":"Financials","shares":49,"position":8746.01},{"rank":12,"ticker":"ADM","momentum":76.2704132023,"atr":3.27531,"price":86.57,"sector":"Consumer Staples","shares":76,"position":6579.32},{"rank":13,"ticker":"WRB","momentum":75.4544995335,"atr":1.82779,"price":67.84,"sector":"Financials","shares":136,"position":9226.24},{"rank":14,"ticker":"CTVA","momentum":69.716481361,"atr":1.898755,"price":60.91,"sector":"Materials","shares":131,"position":7979.21},{"rank":15,"ticker":"HAL","momentum":66.2369684299,"atr":1.84705,"price":38.33,"sector":"Energy","shares":135,"position":5174.55},{"rank":16,"ticker":"IRM","momentum":63.3379210922,"atr":1.855855,"price":50.98,"sector":"Real Estate","shares":134,"position":6831.32},{"rank":17,"ticker":"EXC","momentum":60.8844219592,"atr":1.233135,"price":47.89,"sector":"Utilities","shares":202,"position":9673.78},{"rank":18,"ticker":"XOM","momentum":58.3347201923,"atr":3.31125,"price":93.89,"sector":"Energy","shares":75,"position":7041.75},{"rank":19,"ticker":"PXD","momentum":55.2151985612,"atr":11.43771,"price":272.0,"sector":"Energy","shares":21,"position":5712.0},{"rank":20,"ticker":"ABC","momentum":52.3675556454,"atr":4.9665,"price":152.7,"sector":"Health Care","shares":50,"position":7635.0},{"rank":21,"ticker":"ED","momentum":51.5572553789,"atr":2.30575,"price":97.68,"sector":"Utilities","shares":108,"position":10549.44},{"rank":22,"ticker":"NOC","momentum":46.93292033,"atr":12.1998,"price":456.77,"sector":"Industrials","shares":20,"position":9135.4},{"rank":23,"ticker":"CNP","momentum":46.8334852921,"atr":0.72725,"price":30.84,"sector":"Utilities","shares":343,"position":10578.12},{"rank":24,"ticker":"AEP","momentum":42.7283196064,"atr":2.50845,"price":100.27,"sector":"Utilities","shares":99,"position":9926.73},{"rank":25,"ticker":"ANTM","momentum":39.8584613097,"atr":14.3485,"price":494.85,"sector":"Health Care","shares":17,"position":8412.45},{"rank":26,"ticker":"MRK","momentum":39.5195527207,"atr":2.15101,"price":93.83,"sector":"Health Care","shares":116,"position":10884.28},{"rank":27,"ticker":"LMT","momentum":37.918579944,"atr":10.6451,"price":433.03,"sector":"Industrials","shares":23,"position":9959.69},{"rank":28,"ticker":"CI","momentum":36.3422490313,"atr":7.6061,"price":263.37,"sector":"Health Care","shares":32,"position":8427.84},{"rank":29,"ticker":"LDOS","momentum":34.3611236657,"atr":2.5622,"price":101.85,"sector":"Industrials","shares":97,"position":9879.45},{"rank":30,"ticker":"DTE","momentum":33.806719001,"atr":2.942495,"price":130.79,"sector":"Utilities","shares":84,"position":10986.36},{"rank":31,"ticker":"HST","momentum":33.3975540675,"atr":0.962565,"price":18.73,"sector":"Real Estate","shares":259,"position":4851.07},{"rank":32,"ticker":"PKG","momentum":33.2750931199,"atr":4.30713,"price":152.94,"sector":"Materials","shares":58,"position":8870.52},{"rank":33,"ticker":"SO","momentum":31.3888248692,"atr":1.71026,"price":74.15,"sector":"Utilities","shares":146,"position":10825.9},{"rank":34,"ticker":"PWR","momentum":30.5301811594,"atr":4.90675,"price":116.43,"sector":"Industrials","shares":50,"position":5821.5},{"rank":35,"ticker":"CMS","momentum":30.0926689374,"atr":1.536045,"price":69.63,"sector":"Utilities","shares":162,"position":11280.06},{"rank":36,"ticker":"TMUS","momentum":28.7335772305,"atr":4.563245,"price":129.89,"sector":"Communication Services","shares":54,"position":7014.06},{"rank":37,"ticker":"XEL","momentum":28.4707938093,"atr":1.68285,"price":74.87,"sector":"Utilities","shares":148,"position":11080.76},{"rank":38,"ticker":"EIX","momentum":28.2688892859,"atr":1.8865,"price":66.45,"sector":"Utilities","shares":132,"position":8771.4},{"rank":39,"ticker":"VRTX","momentum":28.1378076113,"atr":9.723245,"price":268.35,"sector":"Health Care","shares":25,"position":6708.75},{"rank":40,"ticker":"JKHY","momentum":27.0505315298,"atr":5.080495,"price":182.35,"sector":"Information Technology","shares":49,"position":8935.15},{"rank":41,"ticker":"TAP","momentum":26.1607759589,"atr":1.781335,"price":52.12,"sector":"Consumer Staples","shares":140,"position":7296.8},{"rank":42,"ticker":"LYB","momentum":25.9667265494,"atr":3.63443,"price":106.71,"sector":"Materials","shares":68,"position":7256.28},{"rank":43,"ticker":"KMI","momentum":25.7055936692,"atr":0.57375,"price":19.16,"sector":"Energy","shares":435,"position":8334.6},{"rank":44,"ticker":"ETR","momentum":25.6724059151,"atr":2.9695,"price":116.8,"sector":"Utilities","shares":84,"position":9811.2},{"rank":45,"ticker":"ROL","momentum":23.4619108837,"atr":1.125555,"price":35.21,"sector":"Industrials","shares":222,"position":7816.62},{"rank":46,"ticker":"AEE","momentum":23.3028240403,"atr":1.92313,"price":93.23,"sector":"Utilities","shares":129,"position":12026.67},{"rank":47,"ticker":"WEC","momentum":22.9104929746,"atr":2.432795,"price":105.02,"sector":"Utilities","shares":102,"position":10712.04},{"rank":48,"ticker":"DUK","momentum":22.8303003753,"atr":2.607135,"price":110.81,"sector":"Utilities","shares":95,"position":10526.95},{"rank":49,"ticker":"HSIC","momentum":21.0706889671,"atr":2.59,"price":84.72,"sector":"Health Care","shares":96,"position":8133.12},{"rank":50,"ticker":"ATO","momentum":20.5461323179,"atr":2.60108,"price":113.67,"sector":"Utilities","shares":96,"position":10912.32},{"rank":51,"ticker":"FMC","momentum":18.5339375174,"atr":4.522715,"price":123.51,"sector":"Materials","shares":55,"position":6793.05},{"rank":52,"ticker":"BALL","momentum":18.1310312978,"atr":0.1,"price":70.81,"sector":"Materials","shares":2500,"position":177025.0},{"rank":53,"ticker":"AMGN","momentum":17.3973514424,"atr":5.904695,"price":249.04,"sector":"Health Care","shares":42,"position":10459.68},{"rank":54,"ticker":"VTR","momentum":16.5533106658,"atr":1.68275,"price":55.95,"sector":"Real Estate","shares":148,"position":8280.6},{"rank":55,"ticker":"J","momentum":15.3254590611,"atr":4.37175,"price":137.15,"sector":"Industrials","shares":57,"position":7817.55},{"rank":56,"ticker":"EVRG","momentum":15.2191251725,"atr":1.593805,"price":68.1,"sector":"Utilities","shares":156,"position":10623.6},{"rank":57,"ticker":"WM","momentum":14.3365243854,"atr":4.6965,"price":156.08,"sector":"Industrials","shares":53,"position":8272.24},{"rank":58,"ticker":"HOLX","momentum":13.5599649364,"atr":2.14825,"price":78.81,"sector":"Health Care","shares":116,"position":9141.96},{"rank":59,"ticker":"PEG","momentum":13.4981167521,"atr":1.47615,"price":68.28,"sector":"Utilities","shares":169,"position":11539.32},{"rank":60,"ticker":"L","momentum":13.3364450404,"atr":1.6675,"price":64.1,"sector":"Financials","shares":149,"position":9550.9},{"rank":61,"ticker":"NI","momentum":12.7663212402,"atr":0.6724,"price":30.75,"sector":"Utilities","shares":371,"position":11408.25},{"rank":62,"ticker":"D","momentum":12.7199719379,"atr":1.994595,"price":83.07,"sector":"Utilities","shares":125,"position":10383.75},{"rank":63,"ticker":"PNW","momentum":12.5325790242,"atr":1.93486,"price":75.19,"sector":"Utilities","shares":129,"position":9699.51},{"rank":64,"ticker":"REGN","momentum":12.4424119601,"atr":20.19506,"price":681.91,"sector":"Health Care","shares":12,"position":8182.92},{"rank":65,"ticker":"CPB","momentum":11.6987492838,"atr":1.4625,"price":46.16,"sector":"Consumer Staples","shares":170,"position":7847.2},{"rank":66,"ticker":"SBAC","momentum":8.9665897803,"atr":12.8455,"price":334.1,"sector":"Real Estate","shares":19,"position":6347.9},{"rank":67,"ticker":"RSG","momentum":7.6452438208,"atr":3.73425,"price":130.96,"sector":"Industrials","shares":66,"position":8643.36},{"rank":68,"ticker":"INCY","momentum":7.1332588623,"atr":2.56474,"price":76.91,"sector":"Health Care","shares":97,"position":7460.27},{"rank":69,"ticker":"CB","momentum":6.9079965978,"atr":5.542125,"price":207.31,"sector":"Financials","shares":45,"position":9328.95},{"rank":70,"ticker":"CERN","momentum":6.7484640824,"atr":0.3512,"price":94.1,"sector":"Health Care","shares":711,"position":66905.1},{"rank":71,"ticker":"ES","momentum":6.6731777046,"atr":2.181785,"price":91.29,"sector":"Utilities","shares":114,"position":10407.06},{"rank":72,"ticker":"SLB","momentum":6.274608561,"atr":2.12175,"price":43.81,"sector":"Energy","shares":117,"position":5125.77},{"rank":73,"ticker":"CHRW","momentum":4.9713880146,"atr":3.896705,"price":104.44,"sector":"Industrials","shares":64,"position":6684.16},{"rank":74,"ticker":"STZ","momentum":3.4769438581,"atr":5.77413,"price":238.67,"sector":"Consumer Staples","shares":43,"position":10262.81},{"rank":75,"ticker":"CNC","momentum":3.4440792245,"atr":3.04425,"price":86.04,"sector":"Health Care","shares":82,"position":7055.28},{"rank":76,"ticker":"AMCR","momentum":2.4265138414,"atr":0.43929,"price":13.05,"sector":"Materials","shares":569,"position":7425.45},{"rank":77,"ticker":"PGR","momentum":2.402608995,"atr":3.224,"price":112.94,"sector":"Financials","shares":77,"position":8696.38},{"rank":78,"ticker":"FANG","momentum":2.4004318896,"atr":7.30972,"price":136.11,"sector":"Energy","shares":34,"position":4627.74},{"rank":79,"ticker":"HWM","momentum":2.0985836174,"atr":1.4332,"price":34.3,"sector":"Industrials","shares":174,"position":5968.2},{"rank":80,"ticker":"PSX","momentum":1.8537061501,"atr":3.77825,"price":95.08,"sector":"Energy","shares":66,"position":6275.28},{"rank":81,"ticker":"CCI","momentum":1.6014522019,"atr":5.03825,"price":185.21,"sector":"Real Estate","shares":49,"position":9075.29},{"rank":82,"ticker":"OGN","momentum":0.9819844372,"atr":1.2833,"price":37.53,"sector":"Health Care","shares":194,"position":7280.82},{"rank":83,"ticker":"LIN","momentum":0.1341841006,"atr":8.84562,"price":320.42,"sector":"Materials","shares":28,"position":8971.76},{"rank":84,"ticker":"IP","momentum":0.1295692517,"atr":1.38375,"price":48.14,"sector":"Materials","shares":180,"position":8665.2},{"rank":85,"ticker":"DGX","momentum":0.1036051522,"atr":3.876375,"price":139.54,"sector":"Health Care","shares":64,"position":8930.56},{"rank":86,"ticker":"PPL","momentum":0.0184456705,"atr":0.625945,"price":29.57,"sector":"Utilities","shares":399,"position":11798.43},{"rank":87,"ticker":"MNST","momentum":0.0076305512,"atr":2.9562,"price":87.05,"sector":"Consumer Staples","shares":84,"position":7312.2},{"rank":88,"ticker":"AMT","momentum":0.0038865059,"atr":7.76602,"price":249.42,"sector":"Real Estate","shares":32,"position":7981.44},{"rank":89,"ticker":"WDC","momentum":-0.0266450339,"atr":2.84051,"price":57.34,"sector":"Information Technology","shares":88,"position":5045.92},{"rank":90,"ticker":"PM","momentum":-0.1889966691,"atr":2.93568,"price":102.91,"sector":"Consumer Staples","shares":85,"position":8747.35},{"rank":91,"ticker":"ADI","momentum":-0.3300500438,"atr":6.137365,"price":161.55,"sector":"Information Technology","shares":40,"position":6462.0},{"rank":92,"ticker":"PFE","momentum":-0.4876995207,"atr":1.50274,"price":52.88,"sector":"Health Care","shares":166,"position":8778.08},{"rank":93,"ticker":"GILD","momentum":-4.8554606325,"atr":1.338995,"price":63.66,"sector":"Health Care","shares":186,"position":11840.76},{"rank":94,"ticker":"CE","momentum":-6.6551050635,"atr":5.95867,"price":151.79,"sector":"Materials","shares":41,"position":6223.39},{"rank":95,"ticker":"EA","momentum":-11.4435606861,"atr":5.001855,"price":133.77,"sector":"Communication Services","shares":49,"position":6554.73}];

        const sectorTypes = ["Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Health Care", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities"];
        function multiSelectHeaderFilter(cell) {
            var values = sectorTypes;

            const filterFunc = (rowData) => {
                return values.includes(rowData['sector']);
            }

            const getSelectedValues = (multiSelect) => {
                var result = [];
                var options = multiSelect && multiSelect.options;
                var opt;

                for (var i = 0, iLen = options.length; i < iLen; i++) {
                opt = options[i];

                if (opt.selected) {
                    result.push(opt.value || opt.text);
                }
                }
                return result;
            }

            const onChange = () => {
                var editor = document.getElementById('sectorSelector');
                values = getSelectedValues(editor);
                console.log("values: " + values);
                cell.getColumn().getTable().removeFilter(filterFunc);
                cell.getColumn().getTable().addFilter(filterFunc);
            }

            var select = document.createElement("select");
            select.multiple = "multiple";
            select.id = 'sectorSelector';
            select.class = "chosen-select";
            select.style = 'width: 100%';
            sectorTypes.forEach(sector => {
                select.innerHTML += "<option id='" + sector + "' value='" + sector + "' selected='selected'>" + sector + "</option>";
            });
            cell.getColumn().getTable().addFilter(filterFunc);
            select.addEventListener('change', onChange);

            return select;
        }

        var table = new Tabulator("#sp500", {
            data: tabledata,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 500,
            tooltips: true,
            columns: [{
                    title: "Rank",
                    field: "rank",
                    sorter: "number",
                }, 
                {
                    title: "Ticker",
                    field: "ticker",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: "input"
                },
                {
                    title: "Sector",
                    field: "sector",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: multiSelectHeaderFilter, 
                    headerFilterLiveFilter: false
                },
                {
                    title: "Momentum",
                    field: "momentum",
                    sorter: "number",
                    hozAlign: "left",
                }, 
                {
                    title: "ATR20d",
                    field: "atr",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Price ($)",
                    field: "price",
                    sorter: "money",
                    hozAlign: "left",
                },
                {
                    title: "Shares",
                    field: "shares",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Position ($)",
                    field: "position",
                    sorter: "money",
                    hozAlign: "left",
                },
            ],
        });
    </script>
</body>

</html>

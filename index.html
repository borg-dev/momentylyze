<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Momentylyze - Hebelwerk Momentumtabelle</title>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

</head>

<body>

    <div id="sp500"></div>
    <script type="text/javascript">
        var tabledata = [{"rank":1,"ticker":"CAH","momentum":111.0916522917,"atr":1.53325,"price":66.21,"sector":"Health Care","shares":163,"position":10792.23},{"rank":2,"ticker":"NDAQ","momentum":82.1485084809,"atr":1.301665,"price":56.96,"sector":"Financials","shares":192,"position":10936.32},{"rank":3,"ticker":"LW","momentum":68.3620325104,"atr":1.9385,"price":77.17,"sector":"Consumer Staples","shares":128,"position":9877.76},{"rank":4,"ticker":"GPC","momentum":68.2386074508,"atr":3.2428,"price":148.64,"sector":"Consumer Discretionary","shares":77,"position":11445.28},{"rank":5,"ticker":"KEYS","momentum":67.3613102309,"atr":3.83634,"price":156.91,"sector":"Information Technology","shares":65,"position":10199.15},{"rank":6,"ticker":"TT","momentum":62.8719359839,"atr":4.19525,"price":144.86,"sector":"Industrials","shares":59,"position":8546.74},{"rank":7,"ticker":"SBUX","momentum":60.3126900399,"atr":2.57023,"price":84.28,"sector":"Consumer Discretionary","shares":97,"position":8175.16},{"rank":8,"ticker":"MOH","momentum":59.775883131,"atr":8.391045,"price":328.2,"sector":"Health Care","shares":29,"position":9517.8},{"rank":9,"ticker":"IT","momentum":55.6547014741,"atr":8.26109,"price":274.96,"sector":"Information Technology","shares":30,"position":8248.8},{"rank":10,"ticker":"ON","momentum":51.2022124916,"atr":3.030995,"price":64.29,"sector":"Information Technology","shares":82,"position":5271.78},{"rank":11,"ticker":"NEE","momentum":50.4154952818,"atr":2.09952,"price":81.08,"sector":"Utilities","shares":119,"position":9648.52},{"rank":12,"ticker":"ORLY","momentum":49.6727210294,"atr":14.00257,"price":693.19,"sector":"Consumer Discretionary","shares":17,"position":11784.23},{"rank":13,"ticker":"XYL","momentum":45.6715552063,"atr":2.5905,"price":88.36,"sector":"Industrials","shares":96,"position":8482.56},{"rank":14,"ticker":"RJF","momentum":43.2345193235,"atr":2.73579,"price":100.0,"sector":"Financials","shares":91,"position":9100.0},{"rank":15,"ticker":"SJM","momentum":42.1835842952,"atr":2.82307,"price":136.59,"sector":"Consumer Staples","shares":88,"position":12019.92},{"rank":16,"ticker":"GIS","momentum":37.6028376759,"atr":1.70351,"price":77.97,"sector":"Consumer Staples","shares":146,"position":11383.62},{"rank":17,"ticker":"HII","momentum":36.7681318174,"atr":5.476815,"price":224.9,"sector":"Industrials","shares":45,"position":10120.5},{"rank":18,"ticker":"RSG","momentum":33.5039145817,"atr":2.522635,"price":138.6,"sector":"Industrials","shares":99,"position":13721.4},{"rank":19,"ticker":"ADP","momentum":32.3551138568,"atr":5.20357,"price":227.62,"sector":"Information Technology","shares":48,"position":10925.76},{"rank":20,"ticker":"WM","momentum":31.504160165,"atr":2.7329,"price":163.22,"sector":"Industrials","shares":91,"position":14853.02},{"rank":21,"ticker":"CDNS","momentum":31.4666444732,"atr":4.54725,"price":163.13,"sector":"Information Technology","shares":54,"position":8809.02},{"rank":22,"ticker":"MCK","momentum":31.4398902651,"atr":8.166245,"price":341.47,"sector":"Health Care","shares":30,"position":10244.1},{"rank":23,"ticker":"CI","momentum":31.3049791032,"atr":5.857625,"price":277.62,"sector":"Health Care","shares":42,"position":11660.04},{"rank":24,"ticker":"IEX","momentum":28.4703282211,"atr":4.285415,"price":198.53,"sector":"Industrials","shares":58,"position":11514.74},{"rank":25,"ticker":"SCHW","momentum":26.6973691204,"atr":2.03943,"price":71.63,"sector":"Financials","shares":122,"position":8738.86},{"rank":26,"ticker":"WMT","momentum":26.5174605971,"atr":2.685775,"price":130.95,"sector":"Consumer Staples","shares":93,"position":12178.35},{"rank":27,"ticker":"CBOE","momentum":18.9097459274,"atr":2.8869,"price":116.97,"sector":"Financials","shares":86,"position":10059.42},{"rank":28,"ticker":"HSY","momentum":18.1971764409,"atr":4.176145,"price":221.43,"sector":"Consumer Staples","shares":59,"position":13064.37},{"rank":29,"ticker":"PFG","momentum":16.1991530459,"atr":1.82294,"price":71.47,"sector":"Financials","shares":137,"position":9791.39},{"rank":30,"ticker":"MTB","momentum":16.0961154611,"atr":5.06854,"price":177.3,"sector":"Financials","shares":49,"position":8687.7},{"rank":31,"ticker":"PGR","momentum":15.3415069402,"atr":2.762095,"price":119.1,"sector":"Financials","shares":90,"position":10719.0},{"rank":32,"ticker":"DRI","momentum":13.0108316219,"atr":3.841895,"price":123.58,"sector":"Consumer Discretionary","shares":65,"position":8032.7},{"rank":33,"ticker":"CTXS","momentum":10.6801392642,"atr":0.36815,"price":103.8,"sector":"Information Technology","shares":679,"position":70480.2},{"rank":34,"ticker":"VRTX","momentum":10.0977590447,"atr":8.121,"price":284.74,"sector":"Health Care","shares":30,"position":8542.2},{"rank":35,"ticker":"NOC","momentum":6.6391857902,"atr":12.05482,"price":474.14,"sector":"Industrials","shares":20,"position":9482.8},{"rank":36,"ticker":"LLY","momentum":0.0209037003,"atr":8.185425,"price":311.1,"sector":"Health Care","shares":30,"position":9333.0}];

        const sectorTypes = ["Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Health Care", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities"];
        function multiSelectHeaderFilter(cell) {
            var values = sectorTypes;

            const filterFunc = (rowData) => {
                return values.includes(rowData['sector']);
            }

            const getSelectedValues = (multiSelect) => {
                var result = [];
                var options = multiSelect && multiSelect.options;
                var opt;

                for (var i = 0, iLen = options.length; i < iLen; i++) {
                opt = options[i];

                if (opt.selected) {
                    result.push(opt.value || opt.text);
                }
                }
                return result;
            }

            const onChange = () => {
                var editor = document.getElementById('sectorSelector');
                values = getSelectedValues(editor);
                console.log("values: " + values);
                cell.getColumn().getTable().removeFilter(filterFunc);
                cell.getColumn().getTable().addFilter(filterFunc);
            }

            var select = document.createElement("select");
            select.multiple = "multiple";
            select.id = 'sectorSelector';
            select.class = "chosen-select";
            select.style = 'width: 100%';
            sectorTypes.forEach(sector => {
                select.innerHTML += "<option id='" + sector + "' value='" + sector + "' selected='selected'>" + sector + "</option>";
            });
            cell.getColumn().getTable().addFilter(filterFunc);
            select.addEventListener('change', onChange);

            return select;
        }

        var table = new Tabulator("#sp500", {
            data: tabledata,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 500,
            tooltips: true,
            columns: [{
                    title: "Rank",
                    field: "rank",
                    sorter: "number",
                }, 
                {
                    title: "Ticker",
                    field: "ticker",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: "input"
                },
                {
                    title: "Sector",
                    field: "sector",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: multiSelectHeaderFilter, 
                    headerFilterLiveFilter: false
                },
                {
                    title: "Momentum",
                    field: "momentum",
                    sorter: "number",
                    hozAlign: "left",
                }, 
                {
                    title: "ATR20d",
                    field: "atr",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Price ($)",
                    field: "price",
                    sorter: "money",
                    hozAlign: "left",
                },
                {
                    title: "Shares",
                    field: "shares",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Position ($)",
                    field: "position",
                    sorter: "money",
                    hozAlign: "left",
                },
            ],
        });
    </script>
</body>

</html>

<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Momentylyze - Hebelwerk Momentumtabelle</title>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

</head>

<body>

    <div id="sp500"></div>
    <script type="text/javascript">
        var tabledata = [{"rank":1,"ticker":"CAH","momentum":106.255446371,"atr":1.64075,"price":66.05,"sector":"Health Care","shares":152,"position":10039.6},{"rank":2,"ticker":"NDAQ","momentum":95.9908587427,"atr":1.3659983333,"price":56.93,"sector":"Financials","shares":183,"position":10418.19},{"rank":3,"ticker":"AES","momentum":82.3653940031,"atr":0.72038,"price":24.29,"sector":"Utilities","shares":347,"position":8428.63},{"rank":4,"ticker":"LW","momentum":78.4193700971,"atr":1.882,"price":77.55,"sector":"Consumer Staples","shares":132,"position":10236.6},{"rank":5,"ticker":"KEYS","momentum":75.4968311001,"atr":4.02784,"price":156.85,"sector":"Information Technology","shares":62,"position":9724.7},{"rank":6,"ticker":"BR","momentum":74.5208502739,"atr":3.64315,"price":154.44,"sector":"Information Technology","shares":68,"position":10501.92},{"rank":7,"ticker":"GPC","momentum":73.5613160966,"atr":3.28991,"price":151.04,"sector":"Consumer Discretionary","shares":75,"position":11328.0},{"rank":8,"ticker":"TT","momentum":68.1620593945,"atr":4.2875,"price":147.58,"sector":"Industrials","shares":58,"position":8559.64},{"rank":9,"ticker":"SBUX","momentum":67.3647047976,"atr":2.59348,"price":84.17,"sector":"Consumer Discretionary","shares":96,"position":8080.32},{"rank":10,"ticker":"NEE","momentum":62.7119030126,"atr":2.07452,"price":82.52,"sector":"Utilities","shares":120,"position":9902.4},{"rank":11,"ticker":"IT","momentum":60.8649427614,"atr":8.3605,"price":276.06,"sector":"Information Technology","shares":29,"position":8005.74},{"rank":12,"ticker":"AJG","momentum":55.9950643306,"atr":3.80341,"price":171.83,"sector":"Financials","shares":65,"position":11168.95},{"rank":13,"ticker":"ON","momentum":54.5559028259,"atr":3.180565,"price":63.31,"sector":"Information Technology","shares":78,"position":4938.18},{"rank":14,"ticker":"MOH","momentum":54.0794780977,"atr":10.104045,"price":328.74,"sector":"Health Care","shares":24,"position":7889.76},{"rank":15,"ticker":"ORLY","momentum":52.5991888814,"atr":14.42382,"price":688.23,"sector":"Consumer Discretionary","shares":17,"position":11699.91},{"rank":16,"ticker":"MSI","momentum":49.322377167,"atr":4.99775,"price":228.76,"sector":"Information Technology","shares":50,"position":11438.0},{"rank":17,"ticker":"XYL","momentum":48.6379770373,"atr":2.6795,"price":89.86,"sector":"Industrials","shares":93,"position":8356.98},{"rank":18,"ticker":"RJF","momentum":44.5047225617,"atr":2.69054,"price":101.97,"sector":"Financials","shares":92,"position":9381.24},{"rank":19,"ticker":"HII","momentum":39.200279831,"atr":5.57956,"price":230.27,"sector":"Industrials","shares":44,"position":10131.88},{"rank":20,"ticker":"ADP","momentum":37.6825988056,"atr":5.25198,"price":230.28,"sector":"Information Technology","shares":47,"position":10823.16},{"rank":21,"ticker":"GIS","momentum":36.1185541335,"atr":1.71151,"price":79.17,"sector":"Consumer Staples","shares":146,"position":11558.82},{"rank":22,"ticker":"RSG","momentum":35.1583009787,"atr":2.596135,"price":140.51,"sector":"Industrials","shares":96,"position":13488.96},{"rank":23,"ticker":"SJM","momentum":34.2122757249,"atr":2.73307,"price":140.65,"sector":"Consumer Staples","shares":91,"position":12799.15},{"rank":24,"ticker":"CI","momentum":33.032043547,"atr":6.011815,"price":277.77,"sector":"Health Care","shares":41,"position":11388.57},{"rank":25,"ticker":"MCK","momentum":32.8157085471,"atr":8.852245,"price":343.27,"sector":"Health Care","shares":28,"position":9611.56},{"rank":26,"ticker":"WM","momentum":32.5221841044,"atr":2.75765,"price":165.74,"sector":"Industrials","shares":90,"position":14916.6},{"rank":27,"ticker":"IEX","momentum":31.362864354,"atr":4.358415,"price":199.31,"sector":"Industrials","shares":57,"position":11360.67},{"rank":28,"ticker":"SCHW","momentum":26.5495985205,"atr":2.08393,"price":70.89,"sector":"Financials","shares":119,"position":8435.91},{"rank":29,"ticker":"KDP","momentum":25.4800968014,"atr":0.7312,"price":37.08,"sector":"Consumer Staples","shares":341,"position":12644.28},{"rank":30,"ticker":"PGR","momentum":18.4173968196,"atr":2.692805,"price":121.53,"sector":"Financials","shares":92,"position":11180.76},{"rank":31,"ticker":"HSY","momentum":17.9238076662,"atr":4.062145,"price":223.94,"sector":"Consumer Staples","shares":61,"position":13660.34},{"rank":32,"ticker":"MTB","momentum":16.8348189607,"atr":5.00579,"price":178.91,"sector":"Financials","shares":49,"position":8766.59},{"rank":33,"ticker":"DG","momentum":16.2776364913,"atr":4.94275,"price":241.62,"sector":"Consumer Discretionary","shares":50,"position":12081.0},{"rank":34,"ticker":"UNH","momentum":16.2195844582,"atr":11.509245,"price":513.61,"sector":"Health Care","shares":21,"position":10785.81},{"rank":35,"ticker":"CVS","momentum":15.2468421142,"atr":2.116315,"price":98.35,"sector":"Health Care","shares":118,"position":11605.3},{"rank":36,"ticker":"PFG","momentum":14.665333593,"atr":1.84244,"price":72.41,"sector":"Financials","shares":135,"position":9775.35},{"rank":37,"ticker":"VRTX","momentum":13.5670714708,"atr":8.05875,"price":283.45,"sector":"Health Care","shares":31,"position":8786.95},{"rank":38,"ticker":"SO","momentum":13.1633962091,"atr":1.55094,"price":74.99,"sector":"Utilities","shares":161,"position":12073.39},{"rank":39,"ticker":"GL","momentum":10.9786261134,"atr":2.09225,"price":99.95,"sector":"Financials","shares":119,"position":11894.05},{"rank":40,"ticker":"SRE","momentum":10.2442897563,"atr":4.01191,"price":161.78,"sector":"Utilities","shares":62,"position":10030.36},{"rank":41,"ticker":"K","momentum":10.0593229845,"atr":1.47638,"price":73.04,"sector":"Consumer Staples","shares":169,"position":12343.76},{"rank":42,"ticker":"CTXS","momentum":9.4868469567,"atr":0.40375,"price":103.75,"sector":"Information Technology","shares":619,"position":64221.25},{"rank":43,"ticker":"RF","momentum":9.4538885824,"atr":0.64038,"price":20.88,"sector":"Financials","shares":390,"position":8143.2},{"rank":44,"ticker":"CAG","momentum":8.4080600835,"atr":0.69725,"price":34.35,"sector":"Consumer Staples","shares":358,"position":12297.3},{"rank":45,"ticker":"NOC","momentum":7.7517390663,"atr":12.38007,"price":478.82,"sector":"Industrials","shares":20,"position":9576.4},{"rank":46,"ticker":"CNP","momentum":6.9170497432,"atr":0.747765,"price":31.56,"sector":"Utilities","shares":334,"position":10541.04},{"rank":47,"ticker":"CPB","momentum":6.5093547209,"atr":1.18875,"price":48.6,"sector":"Consumer Staples","shares":210,"position":10206.0},{"rank":48,"ticker":"GILD","momentum":1.3711081779,"atr":1.551125,"price":62.86,"sector":"Health Care","shares":161,"position":10120.46},{"rank":49,"ticker":"LLY","momentum":0.1049919132,"atr":8.280665,"price":311.46,"sector":"Health Care","shares":30,"position":9343.8},{"rank":50,"ticker":"ALL","momentum":-0.2788878227,"atr":3.1055,"price":127.62,"sector":"Financials","shares":80,"position":10209.6}];

        const sectorTypes = ["Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Health Care", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities"];
        function multiSelectHeaderFilter(cell) {
            var values = sectorTypes;

            const filterFunc = (rowData) => {
                return values.includes(rowData['sector']);
            }

            const getSelectedValues = (multiSelect) => {
                var result = [];
                var options = multiSelect && multiSelect.options;
                var opt;

                for (var i = 0, iLen = options.length; i < iLen; i++) {
                opt = options[i];

                if (opt.selected) {
                    result.push(opt.value || opt.text);
                }
                }
                return result;
            }

            const onChange = () => {
                var editor = document.getElementById('sectorSelector');
                values = getSelectedValues(editor);
                console.log("values: " + values);
                cell.getColumn().getTable().removeFilter(filterFunc);
                cell.getColumn().getTable().addFilter(filterFunc);
            }

            var select = document.createElement("select");
            select.multiple = "multiple";
            select.id = 'sectorSelector';
            select.class = "chosen-select";
            select.style = 'width: 100%';
            sectorTypes.forEach(sector => {
                select.innerHTML += "<option id='" + sector + "' value='" + sector + "' selected='selected'>" + sector + "</option>";
            });
            cell.getColumn().getTable().addFilter(filterFunc);
            select.addEventListener('change', onChange);

            return select;
        }

        var table = new Tabulator("#sp500", {
            data: tabledata,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 500,
            tooltips: true,
            columns: [{
                    title: "Rank",
                    field: "rank",
                    sorter: "number",
                }, 
                {
                    title: "Ticker",
                    field: "ticker",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: "input"
                },
                {
                    title: "Sector",
                    field: "sector",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: multiSelectHeaderFilter, 
                    headerFilterLiveFilter: false
                },
                {
                    title: "Momentum",
                    field: "momentum",
                    sorter: "number",
                    hozAlign: "left",
                }, 
                {
                    title: "ATR20d",
                    field: "atr",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Price ($)",
                    field: "price",
                    sorter: "money",
                    hozAlign: "left",
                },
                {
                    title: "Shares",
                    field: "shares",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Position ($)",
                    field: "position",
                    sorter: "money",
                    hozAlign: "left",
                },
            ],
        });
    </script>
</body>

</html>

<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Momentylyze - Hebelwerk Momentumtabelle</title>
    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

</head>

<body>

    <div id="sp500"></div>
    <script type="text/javascript">
        var tabledata = [{"rank":1,"ticker":"VLO","momentum":242.3445036001,"atr":6.858555,"price":112.24,"sector":"Energy","shares":36,"position":4040.64},{"rank":2,"ticker":"MPC","momentum":108.7737803666,"atr":4.366745,"price":87.94,"sector":"Energy","shares":57,"position":5012.58},{"rank":3,"ticker":"CEG","momentum":58.4992036516,"atr":2.98474,"price":59.42,"sector":"Utilities","shares":83,"position":4931.86},{"rank":4,"ticker":"MRK","momentum":58.1853501279,"atr":1.96925,"price":94.41,"sector":"Health Care","shares":126,"position":11895.66},{"rank":5,"ticker":"T","momentum":56.7106773084,"atr":0.48042,"price":20.78,"sector":"Communication Services","shares":520,"position":10805.6},{"rank":6,"ticker":"XOM","momentum":54.0799949957,"atr":3.63986,"price":89.03,"sector":"Energy","shares":68,"position":6054.04},{"rank":7,"ticker":"LLY","momentum":46.6617566935,"atr":9.60625,"price":327.27,"sector":"Health Care","shares":26,"position":8509.02},{"rank":8,"ticker":"MNST","momentum":36.7498808624,"atr":2.36235,"price":94.21,"sector":"Consumer Staples","shares":105,"position":9892.05},{"rank":9,"ticker":"MCK","momentum":31.9399657735,"atr":8.0385,"price":326.24,"sector":"Health Care","shares":31,"position":10113.44},{"rank":10,"ticker":"WRB","momentum":30.0645823903,"atr":1.532,"price":69.19,"sector":"Financials","shares":163,"position":11277.97},{"rank":11,"ticker":"IBM","momentum":29.9171238242,"atr":2.86344,"price":142.8,"sector":"Information Technology","shares":87,"position":12423.6},{"rank":12,"ticker":"AMCR","momentum":26.874105681,"atr":0.304885,"price":12.37,"sector":"Materials","shares":819,"position":10131.03},{"rank":13,"ticker":"CI","momentum":26.8628475643,"atr":7.578375,"price":267.88,"sector":"Health Care","shares":32,"position":8572.16},{"rank":14,"ticker":"BMY","momentum":26.0564222633,"atr":1.519755,"price":79.98,"sector":"Health Care","shares":164,"position":13116.72},{"rank":15,"ticker":"K","momentum":21.3719082176,"atr":1.6782,"price":70.96,"sector":"Consumer Staples","shares":148,"position":10502.08},{"rank":16,"ticker":"GPC","momentum":19.8141419976,"atr":3.063405,"price":137.14,"sector":"Consumer Discretionary","shares":81,"position":11108.34},{"rank":17,"ticker":"STZ","momentum":19.1741166738,"atr":5.18074,"price":247.42,"sector":"Consumer Staples","shares":48,"position":11876.16},{"rank":18,"ticker":"VICI","momentum":15.1297961798,"atr":1.054105,"price":30.59,"sector":"Real Estate","shares":237,"position":7249.83},{"rank":19,"ticker":"VRTX","momentum":14.6809438266,"atr":8.93962,"price":287.32,"sector":"Health Care","shares":27,"position":7757.64},{"rank":20,"ticker":"CPB","momentum":13.413178875,"atr":1.29675,"price":48.14,"sector":"Consumer Staples","shares":192,"position":9242.88},{"rank":21,"ticker":"NOC","momentum":10.4907953808,"atr":12.905715,"price":466.82,"sector":"Industrials","shares":19,"position":8869.58},{"rank":22,"ticker":"DG","momentum":9.9541625708,"atr":6.153975,"price":246.76,"sector":"Consumer Discretionary","shares":40,"position":9870.4},{"rank":23,"ticker":"ED","momentum":8.1089681756,"atr":2.286085,"price":93.56,"sector":"Utilities","shares":109,"position":10198.04},{"rank":24,"ticker":"AMGN","momentum":7.4337080447,"atr":5.078635,"price":244.85,"sector":"Health Care","shares":49,"position":11997.65},{"rank":25,"ticker":"PGR","momentum":7.4208029407,"atr":2.88675,"price":116.56,"sector":"Financials","shares":86,"position":10024.16},{"rank":26,"ticker":"WEC","momentum":6.6722162663,"atr":2.457645,"price":99.28,"sector":"Utilities","shares":101,"position":10027.28},{"rank":27,"ticker":"TMUS","momentum":5.7926403465,"atr":3.55347,"price":136.54,"sector":"Communication Services","shares":70,"position":9557.8},{"rank":28,"ticker":"AZO","momentum":5.0897617714,"atr":52.24497,"price":2169.27,"sector":"Consumer Discretionary","shares":4,"position":8677.08},{"rank":29,"ticker":"AMT","momentum":4.0608498612,"atr":8.7555,"price":259.33,"sector":"Real Estate","shares":28,"position":7261.24},{"rank":30,"ticker":"TAP","momentum":3.6986871089,"atr":1.5215,"price":55.38,"sector":"Consumer Staples","shares":164,"position":9082.32},{"rank":31,"ticker":"JNJ","momentum":3.6748044637,"atr":3.492645,"price":182.12,"sector":"Health Care","shares":71,"position":12930.52},{"rank":32,"ticker":"HII","momentum":3.6553038408,"atr":5.105595,"price":218.37,"sector":"Industrials","shares":48,"position":10481.76},{"rank":33,"ticker":"CHRW","momentum":3.1410768573,"atr":3.408755,"price":105.14,"sector":"Industrials","shares":73,"position":7675.22},{"rank":34,"ticker":"GIS","momentum":2.9161415253,"atr":1.46037,"price":71.04,"sector":"Consumer Staples","shares":171,"position":12147.84},{"rank":35,"ticker":"ULTA","momentum":2.5221649059,"atr":15.909395,"price":400.49,"sector":"Consumer Discretionary","shares":15,"position":6007.35},{"rank":36,"ticker":"ROL","momentum":2.2090924561,"atr":0.867505,"price":35.28,"sector":"Industrials","shares":288,"position":10160.64},{"rank":37,"ticker":"APD","momentum":1.8254806457,"atr":7.14545,"price":246.18,"sector":"Materials","shares":34,"position":8370.12},{"rank":38,"ticker":"GILD","momentum":1.786670111,"atr":1.434005,"price":62.83,"sector":"Health Care","shares":174,"position":10932.42},{"rank":39,"ticker":"KMB","momentum":1.4280280339,"atr":2.8861,"price":133.59,"sector":"Consumer Staples","shares":86,"position":11488.74},{"rank":40,"ticker":"RSG","momentum":1.3609924333,"atr":2.7887,"price":129.4,"sector":"Industrials","shares":89,"position":11516.6},{"rank":41,"ticker":"PM","momentum":1.1220736375,"atr":2.487805,"price":102.71,"sector":"Consumer Staples","shares":100,"position":10271.0},{"rank":42,"ticker":"HSY","momentum":1.1066058483,"atr":4.541735,"price":220.96,"sector":"Consumer Staples","shares":55,"position":12152.8},{"rank":43,"ticker":"PWR","momentum":0.8476835211,"atr":5.39007,"price":127.91,"sector":"Industrials","shares":46,"position":5883.86},{"rank":44,"ticker":"KO","momentum":0.4494804277,"atr":1.31999,"price":62.91,"sector":"Consumer Staples","shares":189,"position":11889.99},{"rank":45,"ticker":"WAT","momentum":0.3572649889,"atr":9.89048,"price":330.24,"sector":"Health Care","shares":25,"position":8256.0},{"rank":46,"ticker":"BF.B","momentum":0.2742696339,"atr":1.76108,"price":72.0,"sector":"Consumer Staples","shares":141,"position":10152.0},{"rank":47,"ticker":"PFE","momentum":0.227733053,"atr":1.480585,"price":51.88,"sector":"Health Care","shares":168,"position":8715.84},{"rank":48,"ticker":"CTLT","momentum":0.178020892,"atr":3.70534,"price":110.87,"sector":"Health Care","shares":67,"position":7428.29},{"rank":49,"ticker":"INCY","momentum":0.1495349676,"atr":2.22,"price":77.36,"sector":"Health Care","shares":112,"position":8664.32},{"rank":50,"ticker":"ADP","momentum":0.0967449157,"atr":5.57843,"price":218.31,"sector":"Information Technology","shares":44,"position":9605.64},{"rank":51,"ticker":"CL","momentum":0.0857839807,"atr":1.599145,"price":79.88,"sector":"Consumer Staples","shares":156,"position":12461.28},{"rank":52,"ticker":"MCD","momentum":0.0851835079,"atr":4.483845,"price":247.03,"sector":"Consumer Discretionary","shares":55,"position":13586.65},{"rank":53,"ticker":"O","momentum":-0.0000000037,"atr":1.60325,"price":69.44,"sector":"Real Estate","shares":155,"position":10763.2},{"rank":54,"ticker":"DGX","momentum":-0.0001345911,"atr":3.46215,"price":138.56,"sector":"Health Care","shares":72,"position":9976.32},{"rank":55,"ticker":"UNH","momentum":-0.0073662143,"atr":13.8857,"price":505.66,"sector":"Health Care","shares":18,"position":9101.88},{"rank":56,"ticker":"CDNS","momentum":-0.0146445154,"atr":5.89406,"price":154.45,"sector":"Information Technology","shares":42,"position":6486.9},{"rank":57,"ticker":"SYY","momentum":-0.0161665434,"atr":2.126,"price":86.1,"sector":"Consumer Staples","shares":117,"position":10073.7},{"rank":58,"ticker":"AJG","momentum":-0.0247443993,"atr":4.23305,"price":165.23,"sector":"Financials","shares":59,"position":9748.57},{"rank":59,"ticker":"SNPS","momentum":-0.0312162583,"atr":10.99714,"price":311.86,"sector":"Information Technology","shares":22,"position":6860.92},{"rank":60,"ticker":"OGN","momentum":-0.077999464,"atr":1.0595,"price":35.43,"sector":"Health Care","shares":235,"position":8326.05},{"rank":61,"ticker":"MMC","momentum":-0.1812129937,"atr":3.881,"price":158.93,"sector":"Financials","shares":64,"position":10171.52},{"rank":62,"ticker":"CAG","momentum":-0.2642686297,"atr":0.79195,"price":34.05,"sector":"Consumer Staples","shares":315,"position":10725.75},{"rank":63,"ticker":"DRE","momentum":-1.2219623518,"atr":1.826,"price":56.17,"sector":"Real Estate","shares":136,"position":7639.12},{"rank":64,"ticker":"ABBV","momentum":-1.2321768758,"atr":3.5286,"price":153.14,"sector":"Health Care","shares":70,"position":10719.8},{"rank":65,"ticker":"CNC","momentum":-2.1575456418,"atr":2.4435,"price":84.57,"sector":"Health Care","shares":102,"position":8626.14},{"rank":66,"ticker":"BR","momentum":-4.4938026446,"atr":3.589405,"price":146.89,"sector":"Information Technology","shares":69,"position":10135.41},{"rank":67,"ticker":"NEE","momentum":-4.6830712666,"atr":2.42055,"price":77.89,"sector":"Utilities","shares":103,"position":8022.67},{"rank":68,"ticker":"CBOE","momentum":-8.6126902109,"atr":2.37248,"price":114.53,"sector":"Financials","shares":105,"position":12025.65}];

        const sectorTypes = ["Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Health Care", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities"];
        function multiSelectHeaderFilter(cell) {
            var values = sectorTypes;

            const filterFunc = (rowData) => {
                return values.includes(rowData['sector']);
            }

            const getSelectedValues = (multiSelect) => {
                var result = [];
                var options = multiSelect && multiSelect.options;
                var opt;

                for (var i = 0, iLen = options.length; i < iLen; i++) {
                opt = options[i];

                if (opt.selected) {
                    result.push(opt.value || opt.text);
                }
                }
                return result;
            }

            const onChange = () => {
                var editor = document.getElementById('sectorSelector');
                values = getSelectedValues(editor);
                console.log("values: " + values);
                cell.getColumn().getTable().removeFilter(filterFunc);
                cell.getColumn().getTable().addFilter(filterFunc);
            }

            var select = document.createElement("select");
            select.multiple = "multiple";
            select.id = 'sectorSelector';
            select.class = "chosen-select";
            select.style = 'width: 100%';
            sectorTypes.forEach(sector => {
                select.innerHTML += "<option id='" + sector + "' value='" + sector + "' selected='selected'>" + sector + "</option>";
            });
            cell.getColumn().getTable().addFilter(filterFunc);
            select.addEventListener('change', onChange);

            return select;
        }

        var table = new Tabulator("#sp500", {
            data: tabledata,
            layout: "fitColumns",
            pagination: "local",
            paginationSize: 500,
            tooltips: true,
            columns: [{
                    title: "Rank",
                    field: "rank",
                    sorter: "number",
                }, 
                {
                    title: "Ticker",
                    field: "ticker",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: "input"
                },
                {
                    title: "Sector",
                    field: "sector",
                    sorter: "string",
                    hozAlign: "left",
                    headerFilter: multiSelectHeaderFilter, 
                    headerFilterLiveFilter: false
                },
                {
                    title: "Momentum",
                    field: "momentum",
                    sorter: "number",
                    hozAlign: "left",
                }, 
                {
                    title: "ATR20d",
                    field: "atr",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Price ($)",
                    field: "price",
                    sorter: "money",
                    hozAlign: "left",
                },
                {
                    title: "Shares",
                    field: "shares",
                    sorter: "number",
                    hozAlign: "left",
                },
                {
                    title: "Position ($)",
                    field: "position",
                    sorter: "money",
                    hozAlign: "left",
                },
            ],
        });
    </script>
</body>

</html>
